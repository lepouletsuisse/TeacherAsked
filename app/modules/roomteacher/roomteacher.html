<script src="/socket.io/socket.io.js"></script>
<section class="page-header">
    <h1 class="project-name">TeacherAsked</h1>
     </section>
    
    <section class="main-content">
      <h3>
        <span aria-hidden="true" class="octicon octicon-link">Welcome in the room <span class="room-id" ng-bind-html="vm.roomId">4242</span></span>
      </h3>

      <div class="columns" ng-if="vm.room.currentQuestion === undefined">
        <div class="first-column">
          <h4>Ask a question</h4>
          <form ng-submit="vm.submitQuestion()" name="question-form">
            <table class="question-table">
              <tr>
                  <td><label>Question</label></td><td><input type="text" name="question" ng-model="vm.question" ng-init="vm.question=''"></td>
              </tr>
              <tr>
                <td><label>Type of answer</label></td><td>
                  <select name="typeAnswer" ng-model="vm.typeAnswer" vm-init="vm.typeAnswer='text'">
                    <option value="text" selected>Text</option>
                    <option value="multipleAnswer">Multiple choice</option>
                  </select>
                </td>
              </tr>
              <tr ng-if="vm.typeAnswer=='text'">
                <td><label>Correct answer</label></td><td><input type="text" name="correctTextAnswer" ng-model="vm.correctTextAnswer" ng-init="vm.correctMultipleAnswer='0'"></td>
              </tr>
              <tr ng-if="vm.typeAnswer=='multipleAnswer'">
                <td><label>Answer multiple</label></td><td><button type="button" ng-click="vm.addRow()">Add</button><button type="button" ng-click="vm.removeRow()">Remove</button></td>
              </tr>
              <tr ng-repeat="element in vm.dynamicAnswers" ng-if="vm.typeAnswer=='multipleAnswer'">
                <td class="multipleAnswer">Answer {{element.id}}</td><td><input type="text" name="answer" ng-model="element.value"></td>
              </tr>
              <tr ng-if="vm.typeAnswer=='multipleAnswer'">
                <td>Correct answer</td>
                  <td><select name="correctMultipleAnswer" ng-model="vm.correctMultipleAnswer">
                  <option ng-repeat="element in vm.dynamicAnswers" value="{{element.id}}">Answer {{element.id}}</option>
                  </select>
                </td>
              </tr>
              <tr>
                  <td><label>Auto-check answer</label></td><td><input type="checkbox" name="checkAnswer" ng-model="vm.autoCheck" ng-init="vm.autoCheck=true"></td>
              </tr>
              <tr>
                  <td>
                    <div><button type="submit">Ask</button></div>
                  </td>
              </tr>
            </table>
          </form>
        </div>
        <div class="second-column">
            <h4>Connected students</h4>
            <table class="student-table" ng-repeat="student in vm.room.students">
                <tr>
                  <td><a href="">{{student}}</a></td>
                </tr>
            </table>
        </div>
      </div>
      <div ng-if="vm.room.currentQuestion !== undefined">
        <h4>Connected students</h4>
        <table class="student-table" ng-repeat="student in vm.room.students">
            <tr>
              <td><a href="">{{student}}</a></td>
            </tr>
        </table>
      </div>
      
      <button ng-if="vm.room.currentQuestion === undefined" ng-click="vm.closeRoom()">Close the room</button>
      <span ng-if="vm.room.currentQuestion !== undefined">
        <h3 class="currentQuestion-text">{{vm.room.currentQuestion.question}}</h3>
        <div class="close-button">
          <button ng-click="vm.closeQuestion()">Close the current question</button>
        </div>
        <!--<button type="button" class="btn btn-primary" data-toggle="button" ng-init="vm.hideAnswer = true" ng-model="vm.hideAnswer" clicked>
          Hide students answers
        </button>-->
        <label class="hideAnswer-label">Hide students answers</label><input type="checkbox" ng-init="vm.hideAnswer = true" ng-model="vm.hideAnswer" class="hideAnswer-checkbox" checked>
        <table class="answer-table" ng-if="!vm.hideAnswer">
          <tr ng-repeat="answer in vm.room.currentQuestion.studentAnswers track by $index">
            <td><span class="answer-date">{{answer.date.substring(11,19)}}</span> {{answer.student}}:</td><td>{{answer.answer}}</td>
          </tr>
        </table>
      </span>

      <span ng-if="vm.room.questions.length > 0">
        <h4>Statistics</h4>
        <div class="columns">
          <div class="first-column">
            <canvas 
                id="line" 
                class="chart chart-line" 
                chart-data="vm.data"
                chart-labels="vm.labels" 
                chart-series="vm.series" 
                chart-options="vm.options">
            </canvas>
          </div>
          <div class="second-column">
            <table class="statistics2-table">
              <tr>
                <td>Here it is some more statistics</td><td>Here it is some more statistics</td>
              </tr>
              <tr>
                <td>Here it is some more statistics</td><td>Here it is some more statistics</td>
              </tr>
            </table>
          </div>
        </div>
      </span>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/lepouletsuisse/teacherasked">TeacherAsked</a> is maintained by <a href="https://github.com/lepouletsuisse">lepouletsuisse</a>.</span>
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>
</section>
